DELIMITER $$

DROP TRIGGER IF EXISTS `memories_changes_insert` $$

CREATE TRIGGER `memories_changes_insert` AFTER INSERT ON `memories` 
FOR EACH ROW BEGIN
		INSERT INTO `memories_changes` (MEMORY_ID, HARDWARE_ID, CAPTION, DESCRIPTION, CAPACITY, TYPE, SPEED, NUMSLOTS, SERIALNUMBER)
            SELECT NEW.ID, NEW.HARDWARE_ID, NEW.CAPTION, NEW.DESCRIPTION, NEW.CAPACITY, NEW.TYPE, NEW.SPEED, NEW.NUMSLOTS, NEW.SERIALNUMBER 
            FROM dual WHERE (NEW.CAPACITY != '0' AND NEW.CAPACITY != 'No')
			ON DUPLICATE KEY UPDATE
				MEMORY_ID=NEW.ID,
				DELETED=FALSE;
END$$

DELIMITER ;