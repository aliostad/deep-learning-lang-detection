
  CREATE OR REPLACE  VIEW HV_DIVIDEND_COMPUTAION (NAV_WKEND_DT, NAV_SCHEME, NAV_SCHEMECLASS, NAV_SCHCLASS_NAME, NAV_NET_ASSET_AMOUNT, NAV_UNITS, NAV, PREV_NAV_UNITS, UNIT_MOVEMENT, UNREAL_AMOUNT, PREV_UNREAL_AMOUNT, CAMCODE_DIFF, CLOSING_BALANCE, CORPORATE_UNITS, CORPORATE_NET_ASSETS, CORP_DD_DR, CORP_DD_TAX_DR, INDIVIDUAL_UNITS, INDIVIDUAL_NET_ASSETS, INDV_DD_DR, INDV_DD_TAX_DR, CORP_LESS_DD, INDIVIDUAL_LESS_DD, EX_DIVIDEND_NAV, PU_DIVIDEND_NAV) AS 
  SELECT NAV_WKEND_DT,
    NAV_SCHEME,
    NAV_SCHEMECLASS,
    NAV_SCHCLASS_NAME,
    (NAV_NET_ASSET_AMOUNT) NAV_NET_ASSET_AMOUNT,
    ( NAV_UNITS) NAV_UNITS,
    (NAV_NET_ASSET_AMOUNT/ NAV_UNITS) NAV,
    PREV_NAV_UNITS,
    NVL(( NAV_UNITS),0) - NVL(PREV_NAV_UNITS,0) UNIT_MOVEMENT,
    (UNREAL_AMOUNT) UNREAL_AMOUNT,
    prev_unreal_amount ,
    ( nav_units - hupd_capital_control_cams.closing_balance) camcode_diff,
    /* CASE
    WHEN NVL(PREV_NAV_UNITS,0) > 0
    THEN ( AMOUNT + NVL(PREV_UNREAL_AMOUNT,0))/ UNIT_CAPITAL * (NVL(( NAV_UNITS),0) - NVL(PREV_NAV_UNITS,0))
    ELSE TO_NUMBER(0)
    END AS DAILY_UPR_ENTRY,*/
    /* CASE
    WHEN NVL(PREV_NAV_UNITS,0) > 0
    THEN (((NVL(PREV_UNREAL_AMOUNT,0)+ ( -67207167.94) )/ ( NVL(PREV_NAV_UNITS,0)))* (NVL(NVL(( NAV_UNITS),0) - NVL(PREV_NAV_UNITS,0),0)) )
    ELSE TO_NUMBER(0)
    END AS DAILY_UPR_ENTRY, ---OPENING BAL TO BE CONSIDERED...*/
    -- COMMENTED BY RAM TO REMOVE HARDCODING
    HUPD_CAPITAL_CONTROL_CAMS.CLOSING_BALANCE,
    HUPD_CAPITAL_CONTROL_CAMS.OTHERS CORPORATE_UNITS,
    (HUPD_CAPITAL_CONTROL_CAMS.OTHERS        *(NAV_NET_ASSET_AMOUNT/ NAV_UNITS)) CORPORATE_NET_ASSETS,
    (HUPD_CAPITAL_CONTROL_CAMS.OTHERS        * PU_DIVIDEND_NAV) CORP_DD_DR,
    (ROUND((HUPD_CAPITAL_CONTROL_CAMS.OTHERS * PU_DIVIDEND_NAV)*0.3399)-18500-2500) CORP_DD_TAX_DR,
    (NAV_UNITS                               - HUPD_CAPITAL_CONTROL_CAMS.OTHERS) INDIVIDUAL_UNITS,
    ((NAV_UNITS                              - HUPD_CAPITAL_CONTROL_CAMS.OTHERS) *(NAV_NET_ASSET_AMOUNT/ NAV_UNITS)) INDIVIDUAL_NET_ASSETS,
    ((NAV_UNITS                              - HUPD_CAPITAL_CONTROL_CAMS.OTHERS)* PU_DIVIDEND_NAV) INDV_DD_DR,
    ROUND(((NAV_UNITS                        - HUPD_CAPITAL_CONTROL_CAMS.OTHERS)* PU_DIVIDEND_NAV)*0.28325) INDV_DD_TAX_DR,
    ((HUPD_CAPITAL_CONTROL_CAMS.OTHERS       * PU_DIVIDEND_NAV)+((ROUND((HUPD_CAPITAL_CONTROL_CAMS.OTHERS * PU_DIVIDEND_NAV)*0.3399)-18500-2500) ))CORP_LESS_DD,
    ((NAV_UNITS                              - HUPD_CAPITAL_CONTROL_CAMS.OTHERS) + ROUND(((NAV_UNITS - HUPD_CAPITAL_CONTROL_CAMS.OTHERS)* PU_DIVIDEND_NAV)*0.28325))INDIVIDUAL_LESS_DD,
    hupd_dividend.ex_dividend_nav,
    hupd_dividend.pu_dividend_nav
    /*  ((HUPD_CAPITAL_CONTROL_CAMS.OTHERS)        * 0.002) CORP_DD_DR,-- COMMENTED BY RAM TO REMOVE HARDCODING
    (ROUND(((HUPD_CAPITAL_CONTROL_CAMS.OTHERS) * 0.002)*0.3399,0)-18500-2500) CORP_DD_TAX_DR, -- COMMENTED BY RAM TO REMOVE HARDCODING
    ((NAV_UNITS                                - HUPD_CAPITAL_CONTROL_CAMS.OTHERS)* 0.002) INDV_DD_DR,-- COMMENTED BY RAM TO REMOVE HARDCODING
    ROUND(((NAV_UNITS                          - HUPD_CAPITAL_CONTROL_CAMS.OTHERS)* 0.002)*0.28325,0) INDV_DD_TAX_DR -- COMMENTED BY RAM TO REMOVE HARDCODING
    */
  FROM HV_UNREL_NAV_Q,
    HUPD_CAPITAL_CONTROL_CAMS,
    HUPD_OPENING_BALANCE,
    HUPD_DIVIDEND
  WHERE NAV_SCHEME                            = 'HDFCMS'
  AND HUPD_CAPITAL_CONTROL_CAMS.HDFC_AMC_CODE = NAV_SCHEME
    ||NAV_SCHEMECLASS
    --AND NAV_SCHEMECLASS = 'DD'                             ---Commented by Ram to remove the scheme class
    --AND NAV_WKEND_DT BETWEEN '31 MAR 2013' AND '2 APR 2013' -- TO BE REMOVED
  AND HUPD_OPENING_BALANCE.SCHEME = NAV_SCHEME
  and hupd_opening_balance.plan   = nav_schemeclass
  AND HUPD_DIVIDEND.SCHEME        = NAV_SCHEME
  AND HUPD_DIVIDEND.SCHEME_CLASS  = NAV_SCHEMECLASS
  and hupd_opening_balance. value_date = nav_wkend_dt
  and hupd_dividend.value_date = nav_wkend_dt
    --GROUP BY NAV_SCHEMECLASS,NAV_SCHCLASS_NAME,NAV_WKEND_DT, NAV_SCHEME
  ORDER BY 3,1;
 
